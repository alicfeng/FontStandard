{"title":"Angular Integration with Stencil - Stencil","description":"Angular Integration with Stencil","url":"/docs/angular","contributors":["jthoms1","adamdbradley","kensodemann","peterpeterparker","jeanbenitez","mburger81"],"headings":[{"id":"angular","level":1,"text":"Angular"},{"id":"including-the-custom-elements-schema","level":2,"text":"Including the Custom Elements Schema"},{"id":"calling-definecustomelements","level":2,"text":"Calling defineCustomElements"},{"id":"edge-and-ie11-polyfills","level":2,"text":"Edge and IE11 polyfills"},{"id":"accessing-components-using-viewchild-and-viewchildren","level":2,"text":"Accessing components using ViewChild and ViewChildren"},{"id":"bindings","level":2,"text":"Bindings"},{"id":"install","level":3,"text":"Install"},{"id":"stencil-config-setup","level":3,"text":"Stencil Config setup"},{"id":"componentcorepackage","level":4,"text":"componentCorePackage"},{"id":"proxiesfile","level":4,"text":"proxiesFile"},{"id":"valueaccessorconfigs","level":4,"text":"valueAccessorConfigs"},{"id":"setup-of-angular-component-library","level":3,"text":"Setup of Angular Component Library"},{"id":"usage","level":3,"text":"Usage"}],"srcPath":"./src/docs/framework-integration/angular.md","hypertext":["div",null,["h1",{"id":"angular"},"\n  \n  Angular\n  \n"],"\n",["p",null,"Using a Stencil built web component collection within an Angular CLI project is a two-step process. We need to:"],"\n",["ol",null,"\n",["li",null,"Include the ",["code",null,"CUSTOM_ELEMENTS_SCHEMA"]," in the modules that use the components."],"\n",["li",null,"Call ",["code",null,"defineCustomElements()"]," from ",["code",null,"main.ts"]," (or some other appropriate place)."],"\n"],"\n\n",["h2",{"id":"including-the-custom-elements-schema"},"\n  ",["a",{"class":"heading-link","href":"#including-the-custom-elements-schema"},["app-icon",{"name":"link"}],"\n  Including the Custom Elements Schema\n  "],"\n"],"\n",["p",null,"Including the ",["code",null,"CUSTOM_ELEMENTS_SCHEMA"]," in the module allows the use of the web components in the HTML markup without the compiler producing errors. This code should be added into the ",["code",null,"AppModule"]," and in every other modules that use your custom elements.\nHere is an example of adding it to ",["code",null,"AppModule"],":"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," BrowserModule ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'@angular/platform-browser'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," ",["span",{"class":"token constant"},"CUSTOM_ELEMENTS_SCHEMA"],["span",{"class":"token punctuation"},","]," NgModule ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'@angular/core'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," FormsModule ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'@angular/forms'"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," AppComponent ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'./app.component'"],["span",{"class":"token punctuation"},";"],"\n\n@",["span",{"class":"token function"},"NgModule"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},"{"],"\n  declarations",["span",{"class":"token operator"},":"]," ",["span",{"class":"token punctuation"},"["],"AppComponent",["span",{"class":"token punctuation"},"]"],["span",{"class":"token punctuation"},","],"\n  imports",["span",{"class":"token operator"},":"]," ",["span",{"class":"token punctuation"},"["],"BrowserModule",["span",{"class":"token punctuation"},","]," FormsModule",["span",{"class":"token punctuation"},"]"],["span",{"class":"token punctuation"},","],"\n  bootstrap",["span",{"class":"token operator"},":"]," ",["span",{"class":"token punctuation"},"["],"AppComponent",["span",{"class":"token punctuation"},"]"],["span",{"class":"token punctuation"},","],"\n  schemas",["span",{"class":"token operator"},":"]," ",["span",{"class":"token punctuation"},"["],["span",{"class":"token constant"},"CUSTOM_ELEMENTS_SCHEMA"],["span",{"class":"token punctuation"},"]"],["span",{"class":"token punctuation"},","],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],"\n",["span",{"class":"token keyword"},"export"]," ",["span",{"class":"token keyword"},"class"]," ",["span",{"class":"token class-name"},"AppModule"]," ",["span",{"class":"token punctuation"},"{"],["span",{"class":"token punctuation"},"}"]]],"\n  "],"\n  ",["p",null,"The ",["code",null,"CUSTOM_ELEMENTS_SCHEMA"]," needs to be included in any module that uses custom elements."],"\n\n",["h2",{"id":"calling-definecustomelements"},"\n  ",["a",{"class":"heading-link","href":"#calling-definecustomelements"},["app-icon",{"name":"link"}],"\n  Calling defineCustomElements\n  "],"\n"],"\n",["p",null,"A component collection built with Stencil includes a main function that is used to load the components in the collection. That function is called ",["code",null,"defineCustomElements()"]," and it needs to be called once during the bootstrapping of your application. One convenient place to do this is in ",["code",null,"main.ts"]," as such:"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," enableProdMode ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'@angular/core'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," platformBrowserDynamic ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'@angular/platform-browser-dynamic'"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," AppModule ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'./app/app.module'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," environment ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'./environments/environment'"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token comment"},"// Note: loader import location set using \"esmLoaderPath\" within the output target config"],"\n",["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," defineCustomElements ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'test-components/loader'"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"if"]," ",["span",{"class":"token punctuation"},"("],"environment",["span",{"class":"token punctuation"},"."],"production",["span",{"class":"token punctuation"},")"]," ",["span",{"class":"token punctuation"},"{"],"\n  ",["span",{"class":"token function"},"enableProdMode"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token punctuation"},"}"],"\n\n",["span",{"class":"token function"},"platformBrowserDynamic"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"bootstrapModule"],["span",{"class":"token punctuation"},"("],"AppModule",["span",{"class":"token punctuation"},")"],"\n  ",["span",{"class":"token punctuation"},"."],["span",{"class":"token keyword"},"catch"],["span",{"class":"token punctuation"},"("],["span",{"class":"token parameter"},"err"]," ",["span",{"class":"token operator"},"=>"]," ",["span",{"class":"token builtin"},"console"],["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"log"],["span",{"class":"token punctuation"},"("],"err",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token function"},"defineCustomElements"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  \n",["h2",{"id":"edge-and-ie11-polyfills"},"\n  ",["a",{"class":"heading-link","href":"#edge-and-ie11-polyfills"},["app-icon",{"name":"link"}],"\n  Edge and IE11 polyfills\n  "],"\n"],"\n",["p",null,"If you want your custom elements to be able to work on older browsers, you should add the ",["code",null,"applyPolyfills()"]," that surround the ",["code",null,"defineCustomElements()"]," function."],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," applyPolyfills",["span",{"class":"token punctuation"},","]," defineCustomElements ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'test-components/loader'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token operator"},"..."],"\n",["span",{"class":"token function"},"applyPolyfills"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"then"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"]," ",["span",{"class":"token operator"},"=>"]," ",["span",{"class":"token punctuation"},"{"],"\n  ",["span",{"class":"token function"},"defineCustomElements"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],"\n"]],"\n  "],"\n  \n",["h2",{"id":"accessing-components-using-viewchild-and-viewchildren"},"\n  ",["a",{"class":"heading-link","href":"#accessing-components-using-viewchild-and-viewchildren"},["app-icon",{"name":"link"}],"\n  Accessing components using ViewChild and ViewChildren\n  "],"\n"],"\n",["p",null,"Once included, components could be referenced in your code using ",["code",null,"ViewChild"]," and ",["code",null,"ViewChildren"]," as in the following example:"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"],"Component",["span",{"class":"token punctuation"},","]," ElementRef",["span",{"class":"token punctuation"},","]," ViewChild",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'@angular/core'"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token string"},"'test-components'"],["span",{"class":"token punctuation"},";"],"\n\n@",["span",{"class":"token function"},"Component"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},"{"],"\n    selector",["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'app-home'"],["span",{"class":"token punctuation"},","],"\n    template",["span",{"class":"token operator"},":"]," ",["span",{"class":"token template-string"},["span",{"class":"token template-punctuation string"},"`"],["span",{"class":"token string"},"<test-components #test></test-components>"],["span",{"class":"token template-punctuation string"},"`"]],["span",{"class":"token punctuation"},","],"\n    styleUrls",["span",{"class":"token operator"},":"]," ",["span",{"class":"token punctuation"},"["],["span",{"class":"token string"},"'./home.component.scss'"],["span",{"class":"token punctuation"},"]"],["span",{"class":"token punctuation"},","],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],"\n",["span",{"class":"token keyword"},"export"]," ",["span",{"class":"token keyword"},"class"]," ",["span",{"class":"token class-name"},"HomeComponent"]," ",["span",{"class":"token punctuation"},"{"],"\n\n    @",["span",{"class":"token function"},"ViewChild"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'test'"],["span",{"class":"token punctuation"},")"]," myTestComponent",["span",{"class":"token operator"},":"]," ElementRef",["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"<"],["span",{"class":"token class-name"},"HTMLTestComponentElement"]],["span",{"class":"token punctuation"},">"]],["span",{"class":"token plain-text"},";\n\n    async onAction() "],["span",{"class":"token punctuation"},"{"],"\n        ",["span",{"class":"token keyword"},"await"]," ",["span",{"class":"token keyword"},"this"],["span",{"class":"token punctuation"},"."],"myTestComponent",["span",{"class":"token punctuation"},"."],"nativeElement",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"testComponentMethod"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n    ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token plain-text"},"\n}\n"]]],"\n  "],"\n  \n",["h2",{"id":"bindings"},"\n  ",["a",{"class":"heading-link","href":"#bindings"},["app-icon",{"name":"link"}],"\n  Bindings\n  "],"\n"],"\n",["p",null,"Angular has a pretty good story for integration with web components but there are a few issues with the developer experience. With bindings, the web components get wrapped in an Angular component and then immediately become available as Angular Components. Some of the advantages of doing this are that you get types for your components and you also get the ability to use ngmodel on inputs. Your developers then consuming your web components from Angular applications import an actual Angular Library and to them it feels as though they are interacting with Angular components."],"\n\n",["h3",{"id":"install"},"\n  ",["a",{"class":"heading-link","href":"#install"},["app-icon",{"name":"link"}],"\n  Install\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-bash"},["code",{"class":"language-bash"},["span",{"class":"token function"},"npm"]," ",["span",{"class":"token function"},"install"]," @stencil/angular-output-target --save-dev"]],"\n  "],"\n  \n",["h3",{"id":"stencil-config-setup"},"\n  ",["a",{"class":"heading-link","href":"#stencil-config-setup"},["app-icon",{"name":"link"}],"\n  Stencil Config setup\n  "],"\n"],"\n",["p",null,"To make use of the AngularOutputPlugin first import it into your stencil.config.ts file. Then add it as an OutputTarget."],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," Config ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'@stencil/core'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," angularOutputTarget",["span",{"class":"token punctuation"},","]," ValueAccessorConfig ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'@stencil/angular-output-target'"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"export"]," ",["span",{"class":"token keyword"},"const"]," config",["span",{"class":"token operator"},":"]," Config ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token punctuation"},"{"],"\n  ",["span",{"class":"token keyword"},"namespace"],["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'demo'"],["span",{"class":"token punctuation"},","],"\n  outputTargets",["span",{"class":"token operator"},":"]," ",["span",{"class":"token punctuation"},"["],"\n    ",["span",{"class":"token function"},"angularOutputTarget"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},"{"],"\n      componentCorePackage",["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'component-library'"],["span",{"class":"token punctuation"},","],"\n      directivesProxyFile",["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'../component-library-angular/src/directives/proxies.ts'"],["span",{"class":"token punctuation"},","],"\n      valueAccessorConfigs",["span",{"class":"token operator"},":"]," angularValueAccessorBindings",["span",{"class":"token punctuation"},","],"\n    ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},","],"\n    ",["span",{"class":"token punctuation"},"{"],"\n      ",["span",{"class":"token keyword"},"type"],["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'dist'"],["span",{"class":"token punctuation"},","],"\n    ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},","],"\n  ",["span",{"class":"token punctuation"},"]"],["span",{"class":"token punctuation"},","],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  \n",["h4",{"id":"componentcorepackage"},"\n  ",["a",{"class":"heading-link","href":"#componentcorepackage"},["app-icon",{"name":"link"}],"\n  componentCorePackage\n  "],"\n"],"\n",["p",null,"This is the NPM package name of your core stencil package. In the case of Ionic we chose ‘@ionic/core’. This is the package that gets published that contains just your web components. This package is then used by the Angular package as a dependency"],"\n\n",["h4",{"id":"proxiesfile"},"\n  ",["a",{"class":"heading-link","href":"#proxiesfile"},["app-icon",{"name":"link"}],"\n  proxiesFile\n  "],"\n"],"\n",["p",null,"This is the output file that gets generated by the outputTarget. This file should be referencing a different package location. In the example case we are choosing a sibling directory’s src directory. We will then create an Angular package that exports all components defined in this file."],"\n\n",["h4",{"id":"valueaccessorconfigs"},"\n  ",["a",{"class":"heading-link","href":"#valueaccessorconfigs"},["app-icon",{"name":"link"}],"\n  valueAccessorConfigs\n  "],"\n"],"\n",["p",null,"In order for ngmodel to work on input components we need to define certain pieces of information about the input components. Unfortunately the Stencil compiler cannot infer the intent of components because this is a very conceptual idea."],"\n\n",["h3",{"id":"setup-of-angular-component-library"},"\n  ",["a",{"class":"heading-link","href":"#setup-of-angular-component-library"},["app-icon",{"name":"link"}],"\n  Setup of Angular Component Library\n  "],"\n"],"\n",["p",null,"There is an example component library package available on Github so that you can get started. This repo will likely live as a sibling to your Stencil component library. ",["a",{"href":"https://github.com/ionic-team/stencil-ds-angular-template"},"https://github.com/ionic-team/stencil-ds-angular-template"]],"\n\n",["h3",{"id":"usage"},"\n  ",["a",{"class":"heading-link","href":"#usage"},["app-icon",{"name":"link"}],"\n  Usage\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," ComponentLibraryModule ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'component-library-angular'"],["span",{"class":"token punctuation"},";"],"\n\n@",["span",{"class":"token function"},"NgModule"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},"{"],"\n  ",["span",{"class":"token operator"},"..."],"\n  imports",["span",{"class":"token operator"},":"]," ",["span",{"class":"token punctuation"},"["],"\n    ComponentLibraryModule\n  ",["span",{"class":"token punctuation"},"]"],["span",{"class":"token punctuation"},","],"\n  ",["span",{"class":"token operator"},"..."],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],"\n",["span",{"class":"token keyword"},"export"]," ",["span",{"class":"token keyword"},"class"]," ",["span",{"class":"token class-name"},"AppModule"]," ",["span",{"class":"token punctuation"},"{"]," ",["span",{"class":"token punctuation"},"}"]]],"\n  "]]}