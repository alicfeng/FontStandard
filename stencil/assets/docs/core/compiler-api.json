{"title":"Stencil Core Compiler API - Stencil","description":"Stencil Core Compiler API","url":"/docs/compiler-api","contributors":["adamdbradley"],"headings":[{"id":"stencil-core-compiler-api","level":1,"text":"Stencil Core Compiler API"},{"id":"transpile","level":2,"text":"transpile()"},{"id":"transpilesync","level":2,"text":"transpileSync()"},{"id":"createcompiler","level":2,"text":"createCompiler()"},{"id":"createsystem","level":2,"text":"createSystem()"},{"id":"dependencies","level":2,"text":"dependencies"},{"id":"loadconfig","level":2,"text":"loadConfig()"},{"id":"optimizecss","level":2,"text":"optimizeCss()"},{"id":"optimizejs","level":2,"text":"optimizeJs()"},{"id":"path","level":2,"text":"path"},{"id":"version","level":2,"text":"version"}],"srcPath":"./src/docs/core/compiler-api.md","hypertext":["div",null,["h1",{"id":"stencil-core-compiler-api"},"\n  \n  Stencil Core Compiler API\n  \n"],"\n",["p",null,"The compiler API can be found at ",["code",null,"@stencil/core/compiler/stencil.js"],". This module can \nwork within a NodeJS environment, web worker, and browser window. The\n",["code",null,"stencil.min.js"]," file is also provided and recommended when used within a browser."],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token comment"},"// NodeJS (commonjs)"],"\n",["span",{"class":"token keyword"},"const"]," stencil ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"require"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'@stencil/core/compiler'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token comment"},"// Web Worker from CDN URL (add the version to in the URL)"],"\n",["span",{"class":"token function"},"importScripts"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'https://cdn.jsdelivr.net/npm/@stencil/core@[VERSION]/compiler/stencil.min.js'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token comment"},"// self.stencil will be available after the script import"],"\n\n",["span",{"class":"token comment"},"// Browser Window"],"\n",["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"<"],"script"]," ",["span",{"class":"token attr-name"},"src"],["span",{"class":"token attr-value"},["span",{"class":"token punctuation attr-equals"},"="],["span",{"class":"token punctuation"},"\""],"https://cdn.jsdelivr.net/npm/@stencil/core@[VERSION]/compiler/stencil.min.js",["span",{"class":"token punctuation"},"\""]],["span",{"class":"token punctuation"},">"]],["span",{"class":"token plain-text"}],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"</"],"script"],["span",{"class":"token punctuation"},">"]],"\n",["span",{"class":"token comment"},"// window.stencil will be available after the script executes"]]],"\n  "],"\n  \n",["h2",{"id":"transpile"},"\n  ",["a",{"class":"heading-link","href":"#transpile"},["app-icon",{"name":"link"}],"\n  transpile()\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token function"},"transpile"],["span",{"class":"token punctuation"},"("],"code",["span",{"class":"token operator"},":"]," ",["span",{"class":"token builtin"},"string"],["span",{"class":"token punctuation"},","]," opts",["span",{"class":"token operator"},"?"],["span",{"class":"token operator"},":"]," TranspileOptions",["span",{"class":"token punctuation"},")"],["span",{"class":"token operator"},":"]," ",["span",{"class":"token builtin"},"Promise"],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"<"],["span",{"class":"token class-name"},"TranspileResults"]],["span",{"class":"token punctuation"},">"]]]],"\n  "],"\n  ",["p",null,"The ",["code",null,"transpile()"]," function inputs source code as a string, with various options\nwithin the second argument. The function is stateless and returns a ",["code",null,"Promise"]," of the\nresults, including diagnostics and the transpiled code. The ",["code",null,"transpile()"]," function\ndoes not handle any bundling, minifying, or precompiling any CSS preprocessing like\nSass or Less. "],"\n",["p",null,"The ",["code",null,"transpileSync()"]," equivalent is available so the same function\nit can be called synchronously. However, TypeScript must be already loaded within\nthe global for it to work, where as the async ",["code",null,"transpile()"]," function will load\nTypeScript automatically."],"\n",["p",null,"Since TypeScript is used, the source code will transpile from TypeScript to JavaScript,\nand does not require Babel presets. Additionally, the results includes an ",["code",null,"imports"],"\narray of all the import paths found in the source file. The transpile options can be\nused to set the ",["code",null,"module"]," format, such as ",["code",null,"cjs"],", and JavaScript ",["code",null,"target"]," version, such\nas ",["code",null,"es2017"],"."],"\n\n",["h2",{"id":"transpilesync"},"\n  ",["a",{"class":"heading-link","href":"#transpilesync"},["app-icon",{"name":"link"}],"\n  transpileSync()\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token function"},"transpileSync"],["span",{"class":"token punctuation"},"("],"code",["span",{"class":"token operator"},":"]," ",["span",{"class":"token builtin"},"string"],["span",{"class":"token punctuation"},","]," opts",["span",{"class":"token operator"},"?"],["span",{"class":"token operator"},":"]," TranspileOptions",["span",{"class":"token punctuation"},")"],["span",{"class":"token operator"},":"]," TranspileResults"]],"\n  "],"\n  ",["p",null,"Synchronous equivalent of the ",["code",null,"transpile()"]," function. When used in a browser\nenvironment, TypeScript must already be available globally, where as the async\n",["code",null,"transpile()"]," function will load TypeScript automatically."],"\n\n",["h2",{"id":"createcompiler"},"\n  ",["a",{"class":"heading-link","href":"#createcompiler"},["app-icon",{"name":"link"}],"\n  createCompiler()\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token function"},"createCompiler"],["span",{"class":"token punctuation"},"("],"config",["span",{"class":"token operator"},":"]," Config",["span",{"class":"token punctuation"},")"],["span",{"class":"token operator"},":"]," ",["span",{"class":"token builtin"},"Promise"],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"<"],["span",{"class":"token class-name"},"Compiler"]],["span",{"class":"token punctuation"},">"]]]],"\n  "],"\n  ",["p",null,"The compiler is the utility that brings together many tools to build optimized components, such as a\ntranspiler, bundler and minifier. When using the CLI, the ",["code",null,"stencil build"]," command uses the compiler for\nthe various builds, such as a production build, or watch mode during development. If only one file should\nbe transpiled (converting source code from TypeScript to JavaScript) then the ",["code",null,"transpile()"]," function should be used instead."],"\n",["p",null,"Given a Stencil config, this method asynchronously returns a ",["code",null,"Compiler"]," instance. The config provided\nshould already be created using the ",["code",null,"loadConfig({...})"]," method."],"\n",["p",null,"Below is an example of a NodeJS environment running a full build."],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," createNodeLogger",["span",{"class":"token punctuation"},","]," createNodeSystem ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'@stencil/core/cli'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," createCompiler",["span",{"class":"token punctuation"},","]," loadConfig ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'@stencil/core/compiler'"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"const"]," logger ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token function"},"createNodeLogger"],["span",{"class":"token punctuation"},"("],"process",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"const"]," sys ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token function"},"createNodeSystem"],["span",{"class":"token punctuation"},"("],"process",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"const"]," validated ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"await"]," ",["span",{"class":"token function"},"loadConfig"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},"{"],"\n  logger",["span",{"class":"token punctuation"},","],"\n  sys",["span",{"class":"token punctuation"},","],"\n  config",["span",{"class":"token operator"},":"]," ",["span",{"class":"token punctuation"},"{"],"\n    ",["span",{"class":"token comment"},"/* user config */"],"\n  ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},","],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"const"]," compiler ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"await"]," ",["span",{"class":"token function"},"createCompiler"],["span",{"class":"token punctuation"},"("],"validated",["span",{"class":"token punctuation"},"."],"config",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"const"]," results ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"await"]," compiler",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"build"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  \n",["h2",{"id":"createsystem"},"\n  ",["a",{"class":"heading-link","href":"#createsystem"},["app-icon",{"name":"link"}],"\n  createSystem()\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token function"},"createSystem"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token operator"},":"]," CompilerSystem"]],"\n  "],"\n  ",["p",null,"The compiler uses a ",["code",null,"CompilerSystem"]," instance to access any file system reads and writes. When used\nfrom the CLI, the CLI will provide its own system based on NodeJS. This method provide a compiler\nsystem is in-memory only and independent of any platform."],"\n\n",["h2",{"id":"dependencies"},"\n  ",["a",{"class":"heading-link","href":"#dependencies"},["app-icon",{"name":"link"}],"\n  dependencies\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},"dependencies",["span",{"class":"token operator"},":"]," CompilerDependency",["span",{"class":"token punctuation"},"["],["span",{"class":"token punctuation"},"]"]]],"\n  "],"\n  ",["p",null,"The ",["code",null,"dependencies"]," array is only informational and provided to state which versions of dependencies\nthe compiler was built and works with. For example, the version of TypeScript, Rollup and Terser used\nfor this version of Stencil are listed here."],"\n\n",["h2",{"id":"loadconfig"},"\n  ",["a",{"class":"heading-link","href":"#loadconfig"},["app-icon",{"name":"link"}],"\n  loadConfig()\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token function"},"loadConfig"],["span",{"class":"token punctuation"},"("],"init",["span",{"class":"token operator"},"?"],["span",{"class":"token operator"},":"]," LoadConfigInit",["span",{"class":"token punctuation"},")"],["span",{"class":"token operator"},":"]," ",["span",{"class":"token builtin"},"Promise"],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"<"],["span",{"class":"token class-name"},"LoadConfigResults"]],["span",{"class":"token punctuation"},">"]]]],"\n  "],"\n  ",["p",null,"The ",["code",null,"loadConfig(init)"]," method is used to take raw config information and transform it into a\nusable config object for the compiler and dev-server. The ",["code",null,"init"]," argument should be given\nan already created system and logger which can also be used by the compiler."],"\n\n",["h2",{"id":"optimizecss"},"\n  ",["a",{"class":"heading-link","href":"#optimizecss"},["app-icon",{"name":"link"}],"\n  optimizeCss()\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token function"},"optimizeCss"],["span",{"class":"token punctuation"},"("],"cssInput",["span",{"class":"token operator"},"?"],["span",{"class":"token operator"},":"]," OptimizeCssInput",["span",{"class":"token punctuation"},")"],["span",{"class":"token operator"},":"]," ",["span",{"class":"token builtin"},"Promise"],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"<"],["span",{"class":"token class-name"},"OptimizeCssOutput"]],["span",{"class":"token punctuation"},">"]]]],"\n  "],"\n  ",["p",null,"Utility function used by the compiler to optimize CSS."],"\n\n",["h2",{"id":"optimizejs"},"\n  ",["a",{"class":"heading-link","href":"#optimizejs"},["app-icon",{"name":"link"}],"\n  optimizeJs()\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-jsx"},["code",{"class":"language-jsx"},"optimizeJs(jsInput?: OptimizeJsInput): Promise",["optimizejsoutput",null]]],"\n  "],"\n  ",["p",null,"Utility function used by the compiler to optimize JavaScript. Knowing the JavaScript target\nwill further apply minification optimizations beyond usual minification."],"\n\n",["h2",{"id":"path"},"\n  ",["a",{"class":"heading-link","href":"#path"},["app-icon",{"name":"link"}],"\n  path\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},"path",["span",{"class":"token operator"},":"]," PlatformPath"]],"\n  "],"\n  ",["p",null,"Utility of the ",["code",null,"path"]," API providied by NodeJS, but capable of running in any environment.\nThis ",["code",null,"path"]," API is only the POSIX version: ",["a",{"href":"https://nodejs.org/api/path.html"},"https://nodejs.org/api/path.html"]],"\n\n",["h2",{"id":"version"},"\n  ",["a",{"class":"heading-link","href":"#version"},["app-icon",{"name":"link"}],"\n  version\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},"version",["span",{"class":"token operator"},":"]," ",["span",{"class":"token builtin"},"string"]]],"\n  "],"\n  ",["p",null,"Current version of ",["code",null,"@stencil/core"],"."]]}