{"title":"React Integration with Stencil - Stencil","description":"React Integration with Stencil","url":"/docs/react","contributors":["jthoms1","adamdbradley","kensodemann","ErikSchierboom","brentertz","danawoodman","iryan2","manucorporat","Artur93gev","whoisryosuke","peterpeterparker","ncphillips","s-soltys"],"lastUpdated":"2021-03-25T17:16:00Z","headings":[{"id":"react","level":1,"text":"React"},{"id":"properties-and-events","level":2,"text":"Properties and Events"},{"id":"bindings","level":2,"text":"Bindings"},{"id":"install","level":3,"text":"Install"},{"id":"stencil-config-setup","level":3,"text":"Stencil Config setup"},{"id":"componentcorepackage","level":4,"text":"componentCorePackage"},{"id":"proxiesfile","level":4,"text":"proxiesFile"},{"id":"includedefinecustomelements","level":4,"text":"includeDefineCustomElements"},{"id":"setup-of-react-component-library","level":3,"text":"Setup of React Component Library"},{"id":"usage","level":3,"text":"Usage"}],"srcPath":"./src/docs/framework-integration/react.md","hypertext":["div",null,["h1",{"id":"react"},"\n  \n  React\n  \n"],"\n",["p",null,"With an application built using the ",["code",null,"create-react-app"]," script the easiest way to include the component library is to call ",["code",null,"defineCustomElements()"]," from the ",["code",null,"index.js"]," file.\nNote that in this scenario ",["code",null,"applyPolyfills"]," is needed if you are targeting Edge or IE11."],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token keyword"},"import"]," React ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'react'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"import"]," ReactDOM ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'react-dom'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token string"},"'./index.css'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"import"]," App ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'./App'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"import"]," registerServiceWorker ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'./registerServiceWorker'"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token comment"},"// test-component is the name of our made up Web Component that we have"],"\n",["span",{"class":"token comment"},"// published to npm:"],"\n",["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," applyPolyfills",["span",{"class":"token punctuation"},","]," defineCustomElements ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'test-components/loader'"],["span",{"class":"token punctuation"},";"],"\n\nReactDOM",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"render"],["span",{"class":"token punctuation"},"("],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"<"],["span",{"class":"token class-name"},"App"]]," ",["span",{"class":"token punctuation"},"/>"]],["span",{"class":"token punctuation"},","]," document",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"getElementById"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'root'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token function"},"registerServiceWorker"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token function"},"applyPolyfills"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"then"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"]," ",["span",{"class":"token operator"},"=>"]," ",["span",{"class":"token punctuation"},"{"],"\n  ",["span",{"class":"token function"},"defineCustomElements"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  ",["p",null,"Following the steps above will enable your web components to be used in React, however there are some additional complexities that must also be considered.  ",["a",{"href":"https://custom-elements-everywhere.com/"},"https://custom-elements-everywhere.com/"]," contains a synopsis of the current issues."],"\n\n",["h2",{"id":"properties-and-events"},"\n  ",["a",{"class":"heading-link","href":"#properties-and-events"},["app-icon",{"name":"link"}],"\n  Properties and Events\n  "],"\n"],"\n",["p",null,"The largest deficiencies that React currently has when it comes to working with standard HTML Custom Elements is that properties that contain non-scalar data (that is, data that is not a string or number) are not passed properly and custom events are not handled properly. The solution to both of these problems is to wrap the Custom Element in a React component, obtain a ",["code",null,"ref"]," to the Custom Element, and use the ",["code",null,"ref"]," in order to set the non-scalar properties and add event listeners via ",["code",null,"addEventListener"],". Here is an example showing how this works for the property passing:"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token keyword"},"import"]," React",["span",{"class":"token punctuation"},","]," ",["span",{"class":"token punctuation"},"{"]," useRef",["span",{"class":"token punctuation"},","]," useEffect ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'react'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," Forecast ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'../models'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," iconPaths ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'../util'"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"const"]," DailyForecast",["span",{"class":"token operator"},":"]," React",["span",{"class":"token punctuation"},"."],["span",{"class":"token constant"},"FC"],["span",{"class":"token operator"},"<"],["span",{"class":"token punctuation"},"{"]," forecast",["span",{"class":"token operator"},":"]," Forecast",["span",{"class":"token punctuation"},";"]," scale",["span",{"class":"token operator"},":"]," ",["span",{"class":"token builtin"},"string"]," ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token operator"},">"]," ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token punctuation"},"("],["span",{"class":"token parameter"},["span",{"class":"token punctuation"},"{"]," forecast",["span",{"class":"token punctuation"},","]," scale ",["span",{"class":"token punctuation"},"}"]],["span",{"class":"token punctuation"},")"]," ",["span",{"class":"token operator"},"=>"]," ",["span",{"class":"token punctuation"},"{"],"\n  ",["span",{"class":"token keyword"},"const"]," elementRef ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token function"},"useRef"],["span",{"class":"token punctuation"},"("],["span",{"class":"token keyword"},"null"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n  ",["span",{"class":"token function"},"useEffect"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"]," ",["span",{"class":"token operator"},"=>"]," ",["span",{"class":"token punctuation"},"{"],"\n    ",["span",{"class":"token punctuation"},"("],"elementRef",["span",{"class":"token punctuation"},"."],"current ",["span",{"class":"token keyword"},"as"]," ",["span",{"class":"token builtin"},"any"],["span",{"class":"token punctuation"},")"],["span",{"class":"token operator"},"!"],["span",{"class":"token punctuation"},"."],"iconPaths ",["span",{"class":"token operator"},"="]," iconPaths",["span",{"class":"token punctuation"},";"],"\n    ",["span",{"class":"token punctuation"},"("],"elementRef",["span",{"class":"token punctuation"},"."],"current ",["span",{"class":"token keyword"},"as"]," ",["span",{"class":"token builtin"},"any"],["span",{"class":"token punctuation"},")"],["span",{"class":"token operator"},"!"],["span",{"class":"token punctuation"},"."],"forecasts ",["span",{"class":"token operator"},"="]," forecast",["span",{"class":"token punctuation"},";"],"\n  ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},","]," ",["span",{"class":"token punctuation"},"["],"forecast",["span",{"class":"token punctuation"},"]"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n  ",["span",{"class":"token keyword"},"return"]," ",["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"<"],"kws-daily-forecast"]," ",["span",{"class":"token attr-name"},"scale"],["span",{"class":"token script language-javascript"},["span",{"class":"token script-punctuation punctuation"},"="],["span",{"class":"token punctuation"},"{"],"scale",["span",{"class":"token punctuation"},"}"]]," ",["span",{"class":"token attr-name"},"ref"],["span",{"class":"token script language-javascript"},["span",{"class":"token script-punctuation punctuation"},"="],["span",{"class":"token punctuation"},"{"],"elementRef",["span",{"class":"token punctuation"},"}"]],["span",{"class":"token punctuation"},">"]],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"</"],"kws-daily-forecast"],["span",{"class":"token punctuation"},">"]],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"export"]," ",["span",{"class":"token keyword"},"default"]," DailyForecast",["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  ",["p",null,"In this example, there are three properties: ",["code",null,"forecast"]," is an array of objects, ",["code",null,"iconPaths"]," is an object, and ",["code",null,"scale"]," is a string. Since ",["code",null,"scale"]," is a string it can be handled normally. However, the other two properties are non-scalar and must be set via the ",["code",null,"ref"]," to the Custom Element. Wrapping the Custom Element as such prevents you from having to obtain a ",["code",null,"ref"]," with every instance of ",["code",null,"kws-daily-forecast"]," that you may need since you will instead be using the ",["code",null,"DailyForecast"]," React component as such:"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"<"],["span",{"class":"token class-name"},"DailyForecast"]]," ",["span",{"class":"token attr-name"},"scale"],["span",{"class":"token script language-javascript"},["span",{"class":"token script-punctuation punctuation"},"="],["span",{"class":"token punctuation"},"{"],"scale",["span",{"class":"token punctuation"},"}"]]," ",["span",{"class":"token attr-name"},"forecast"],["span",{"class":"token script language-javascript"},["span",{"class":"token script-punctuation punctuation"},"="],["span",{"class":"token punctuation"},"{"],"f",["span",{"class":"token punctuation"},"}"]],["span",{"class":"token punctuation"},">"]],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"</"],["span",{"class":"token class-name"},"DailyForecast"]],["span",{"class":"token punctuation"},">"]]]],"\n  "],"\n  \n",["h2",{"id":"bindings"},"\n  ",["a",{"class":"heading-link","href":"#bindings"},["app-icon",{"name":"link"}],"\n  Bindings\n  "],"\n"],"\n",["p",null,"Manually wrapping all Custom Elements in a React Component is a good practice, but it gets tedious quickly."],"\n",["p",null,"With bindings the web components get wrapped in a React component and then immediately become available as React Components. Some of the advantages of doing this are that you get types for your components. One of the main issues with React is that react does not properly pass properties to web components. Out of the box React can only pass strings and numbers to components and it cannot listen to custom events. With the bindings the components appear as though they are React components and all properties get passed correctly including functions, objects, and arrays. The bindings also account for custom events by creating a prop called ‘on",["eventname",null,"’. These allow React developers to interact with the web components as though they are React components."]],"\n\n",["h3",{"id":"install"},"\n  ",["a",{"class":"heading-link","href":"#install"},["app-icon",{"name":"link"}],"\n  Install\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-bash"},["code",{"class":"language-bash"},["span",{"class":"token function"},"npm"]," ",["span",{"class":"token function"},"install"]," @stencil/react-output-target --save-dev"]],"\n  "],"\n  \n",["h3",{"id":"stencil-config-setup"},"\n  ",["a",{"class":"heading-link","href":"#stencil-config-setup"},["app-icon",{"name":"link"}],"\n  Stencil Config setup\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," Config ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'@stencil/core'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," reactOutputTarget ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'@stencil/react-output-target'"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"export"]," ",["span",{"class":"token keyword"},"const"]," config",["span",{"class":"token operator"},":"]," Config ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token punctuation"},"{"],"\n  ",["span",{"class":"token keyword"},"namespace"],["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'demo'"],["span",{"class":"token punctuation"},","],"\n  outputTargets",["span",{"class":"token operator"},":"]," ",["span",{"class":"token punctuation"},"["],"\n    ",["span",{"class":"token function"},"reactOutputTarget"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},"{"],"\n      componentCorePackage",["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'component-library'"],["span",{"class":"token punctuation"},","],"\n      proxiesFile",["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'../component-library-react/src/components.ts'"],["span",{"class":"token punctuation"},","],"\n      includeDefineCustomElements",["span",{"class":"token operator"},":"]," ",["span",{"class":"token boolean"},"true"],["span",{"class":"token punctuation"},","],"\n    ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},","],"\n    ",["span",{"class":"token punctuation"},"{"],"\n      ",["span",{"class":"token keyword"},"type"],["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'dist'"],["span",{"class":"token punctuation"},","],"\n    ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},","],"\n  ",["span",{"class":"token punctuation"},"]"],["span",{"class":"token punctuation"},","],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  \n",["h4",{"id":"componentcorepackage"},"\n  ",["a",{"class":"heading-link","href":"#componentcorepackage"},["app-icon",{"name":"link"}],"\n  componentCorePackage\n  "],"\n"],"\n",["p",null,"This is the NPM package name of your core stencil package. In the case of Ionic we chose ‘@ionic/core’. This is the package that gets published that contains just your web components. This package is then used by the React package as a dependency"],"\n\n",["h4",{"id":"proxiesfile"},"\n  ",["a",{"class":"heading-link","href":"#proxiesfile"},["app-icon",{"name":"link"}],"\n  proxiesFile\n  "],"\n"],"\n",["p",null,"This is the output file that gets generated by the outputTarget. This file should be referencing a different package location. In the example case we are choosing a sibling directory’s src directory. We will then create a React package that exports all components defined in this file."],"\n\n",["h4",{"id":"includedefinecustomelements"},"\n  ",["a",{"class":"heading-link","href":"#includedefinecustomelements"},["app-icon",{"name":"link"}],"\n  includeDefineCustomElements\n  "],"\n"],"\n",["p",null,"This means the consuming application doesn't have to manually import and call ",["code",null,"defineCustomElements()"],", and the components can be used as described below."],"\n\n",["h3",{"id":"setup-of-react-component-library"},"\n  ",["a",{"class":"heading-link","href":"#setup-of-react-component-library"},["app-icon",{"name":"link"}],"\n  Setup of React Component Library\n  "],"\n"],"\n",["p",null,"There is an example component library package available on Github so that you can get started. This repo will likely live as a sibling to your Stencil component library. ",["a",{"href":"https://github.com/ionic-team/stencil-ds-react-template"},"https://github.com/ionic-team/stencil-ds-react-template"]],"\n\n",["h3",{"id":"usage"},"\n  ",["a",{"class":"heading-link","href":"#usage"},["app-icon",{"name":"link"}],"\n  Usage\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," DemoComponent ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'component-library-react'"],["span",{"class":"token punctuation"},";"]]],"\n  "]]}