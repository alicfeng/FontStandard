{"title":"Store - Stencil","description":"Store","url":"/docs/stencil-store","lastUpdated":"2020-07-21T21:39:34Z","contributors":["Serabe","manucorporat"],"headings":[{"id":"stencil-store","level":1,"text":"@stencil/store"},{"id":"installation","level":2,"text":"Installation"},{"id":"example","level":2,"text":"Example"},{"id":"api","level":2,"text":"API"},{"id":"createstoret-initialstate","level":3,"text":"<code>createStore&lt;T&gt;(initialState)</code>"},{"id":"store-state","level":3,"text":"<code>store.state</code>"},{"id":"store-on-event-listener","level":3,"text":"<code>store.on(event, listener)</code>"},{"id":"store-onchange-propname-listener","level":3,"text":"<code>store.onChange(propName, listener)</code>"},{"id":"store-get-propname","level":3,"text":"<code>store.get(propName)</code>"},{"id":"store-set-propname-value","level":3,"text":"<code>store.set(propName, value)</code>"},{"id":"store-reset","level":3,"text":"<code>store.reset()</code>"},{"id":"store-use-subscriptions","level":3,"text":"<code>store.use(...subscriptions)</code>"},{"id":"testing","level":2,"text":"Testing"}],"srcPath":"./src/docs/guides/store.md","hypertext":["div",null,["h1",{"id":"stencil-store"},"\n  \n  @stencil/store\n  \n"],"\n",["p",null,["a",{"href":"https://github.com/ionic-team/stencil-store"},"Store"]," is a lightweight shared state library by the stencil core team. It implements a simple key/value map that efficiently re-renders components when necessary."],"\n",["ul",null,"\n",["li",null,"Lightweight"],"\n",["li",null,"Zero dependencies"],"\n",["li",null,"Simple API, like a reactive Map"],"\n",["li",null,"Best performance"],"\n"],"\n\n",["h2",{"id":"installation"},"\n  ",["a",{"class":"heading-link","href":"#installation"},["app-icon",{"name":"link"}],"\n  Installation\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-bash"},["code",{"class":"language-bash"},["span",{"class":"token function"},"npm"]," ",["span",{"class":"token function"},"install"]," @stencil/store --save-dev"]],"\n  "],"\n  \n",["h2",{"id":"example"},"\n  ",["a",{"class":"heading-link","href":"#example"},["app-icon",{"name":"link"}],"\n  Example\n  "],"\n"],"\n",["p",null,["strong",null,"store.ts:"]],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," createStore ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"\"@stencil/store\""],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"const"]," ",["span",{"class":"token punctuation"},"{"]," state",["span",{"class":"token punctuation"},","]," onChange ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token function"},"createStore"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},"{"],"\n  clicks",["span",{"class":"token operator"},":"]," ",["span",{"class":"token number"},"0"],["span",{"class":"token punctuation"},","],"\n  seconds",["span",{"class":"token operator"},":"]," ",["span",{"class":"token number"},"0"],["span",{"class":"token punctuation"},","],"\n  squaredClicks",["span",{"class":"token operator"},":"]," ",["span",{"class":"token number"},"0"],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token function"},"onChange"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'clicks'"],["span",{"class":"token punctuation"},","]," ",["span",{"class":"token parameter"},"value"]," ",["span",{"class":"token operator"},"=>"]," ",["span",{"class":"token punctuation"},"{"],"\n  state",["span",{"class":"token punctuation"},"."],"squaredClicks ",["span",{"class":"token operator"},"="]," value ",["span",{"class":"token operator"},"**"]," ",["span",{"class":"token number"},"2"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"export"]," ",["span",{"class":"token keyword"},"default"]," state",["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  ",["p",null,["strong",null,"component.tsx:"]],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-tsx"},["code",{"class":"language-tsx"},["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," Component",["span",{"class":"token punctuation"},","]," h ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'@stencil/core'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"import"]," state ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'../store'"],["span",{"class":"token punctuation"},";"],"\n\n@",["span",{"class":"token function"},"Component"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},"{"],"\n  tag",["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'app-profile'"],["span",{"class":"token punctuation"},","],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],"\n",["span",{"class":"token keyword"},"export"]," ",["span",{"class":"token keyword"},"class"]," ",["span",{"class":"token class-name"},"AppProfile"]," ",["span",{"class":"token punctuation"},"{"],"\n\n  ",["span",{"class":"token function"},"componentWillLoad"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"]," ",["span",{"class":"token punctuation"},"{"],"\n    ",["span",{"class":"token function"},"setInterval"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"]," ",["span",{"class":"token operator"},"=>"]," state",["span",{"class":"token punctuation"},"."],"seconds",["span",{"class":"token operator"},"++"],["span",{"class":"token punctuation"},","]," ",["span",{"class":"token number"},"1000"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n  ",["span",{"class":"token punctuation"},"}"],"\n\n  ",["span",{"class":"token function"},"render"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"]," ",["span",{"class":"token punctuation"},"{"],"\n    ",["span",{"class":"token keyword"},"return"]," ",["span",{"class":"token punctuation"},"("],"\n      ",["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"<"],"div"],["span",{"class":"token punctuation"},">"]],["span",{"class":"token plain-text"},"\n        "],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"<"],"p"],["span",{"class":"token punctuation"},">"]],["span",{"class":"token plain-text"},"\n          "],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"<"],["span",{"class":"token class-name"},"MyGlobalCounter"]]," ",["span",{"class":"token punctuation"},"/>"]],["span",{"class":"token plain-text"},"\n          "],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"<"],"p"],["span",{"class":"token punctuation"},">"]],["span",{"class":"token plain-text"},"\n            Seconds: "],["span",{"class":"token punctuation"},"{"],"state",["span",{"class":"token punctuation"},"."],"seconds",["span",{"class":"token punctuation"},"}"],["span",{"class":"token plain-text"},"\n            "],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"<"],"br"]," ",["span",{"class":"token punctuation"},"/>"]],["span",{"class":"token plain-text"},"\n            Squared Clicks: "],["span",{"class":"token punctuation"},"{"],"state",["span",{"class":"token punctuation"},"."],"squaredClicks",["span",{"class":"token punctuation"},"}"],["span",{"class":"token plain-text"},"\n          "],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"</"],"p"],["span",{"class":"token punctuation"},">"]],["span",{"class":"token plain-text"},"\n        "],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"</"],"p"],["span",{"class":"token punctuation"},">"]],["span",{"class":"token plain-text"},"\n      "],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"</"],"div"],["span",{"class":"token punctuation"},">"]],"\n    ",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n  ",["span",{"class":"token punctuation"},"}"],"\n",["span",{"class":"token punctuation"},"}"],"\n\n",["span",{"class":"token keyword"},"const"]," ",["span",{"class":"token function-variable function"},"MyGlobalCounter"]," ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"]," ",["span",{"class":"token operator"},"=>"]," ",["span",{"class":"token punctuation"},"{"],"\n  ",["span",{"class":"token keyword"},"return"]," ",["span",{"class":"token punctuation"},"("],"\n    ",["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"<"],"button"]," ",["span",{"class":"token attr-name"},"onClick"],["span",{"class":"token script language-javascript"},["span",{"class":"token script-punctuation punctuation"},"="],["span",{"class":"token punctuation"},"{"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"]," ",["span",{"class":"token operator"},"=>"]," state",["span",{"class":"token punctuation"},"."],"clicks",["span",{"class":"token operator"},"++"],["span",{"class":"token punctuation"},"}"]],["span",{"class":"token punctuation"},">"]],["span",{"class":"token plain-text"},"\n      "],["span",{"class":"token punctuation"},"{"],"state",["span",{"class":"token punctuation"},"."],"clicks",["span",{"class":"token punctuation"},"}"],["span",{"class":"token plain-text"},"\n    "],["span",{"class":"token tag"},["span",{"class":"token tag"},["span",{"class":"token punctuation"},"</"],"button"],["span",{"class":"token punctuation"},">"]],"\n  ",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  \n",["h2",{"id":"api"},"\n  ",["a",{"class":"heading-link","href":"#api"},["app-icon",{"name":"link"}],"\n  API\n  "],"\n"],"\n\n",["h3",{"id":"createstoret-initialstate"},"\n  ",["a",{"class":"heading-link","href":"#createstoret-initialstate"},["app-icon",{"name":"link"}],"\n  ",["code",null,"createStore<T>(initialState)"],"\n  "],"\n"],"\n",["p",null,"Create a new store with the given initial state. The type is inferred from ",["code",null,"initialState"],", or can be passed as the generic type ",["code",null,"T"],"."],"\n",["p",null,"Returns a ",["code",null,"store"]," object with the following properties."],"\n\n",["h3",{"id":"store-state"},"\n  ",["a",{"class":"heading-link","href":"#store-state"},["app-icon",{"name":"link"}],"\n  ",["code",null,"store.state"],"\n  "],"\n"],"\n",["p",null,"The state object is proxied, i. e. you can directly get and set properties and Store will automatically take care of component re-rendering when the state object is changed."],"\n",["p",null,"Note: ",["a",{"href":"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy"},["code",null,"Proxy"]]," objects are not supported by IE11 (not even with a polyfill), so you need to use the ",["code",null,"store.get"]," and ",["code",null,"store.set"]," methods of the API if you wish to support IE11."],"\n\n",["h3",{"id":"store-on-event-listener"},"\n  ",["a",{"class":"heading-link","href":"#store-on-event-listener"},["app-icon",{"name":"link"}],"\n  ",["code",null,"store.on(event, listener)"],"\n  "],"\n"],"\n",["p",null,"Add a listener to the store for a certain action."],"\n\n",["h3",{"id":"store-onchange-propname-listener"},"\n  ",["a",{"class":"heading-link","href":"#store-onchange-propname-listener"},["app-icon",{"name":"link"}],"\n  ",["code",null,"store.onChange(propName, listener)"],"\n  "],"\n"],"\n",["p",null,"Add a listener that is called when a specific property changes."],"\n\n",["h3",{"id":"store-get-propname"},"\n  ",["a",{"class":"heading-link","href":"#store-get-propname"},["app-icon",{"name":"link"}],"\n  ",["code",null,"store.get(propName)"],"\n  "],"\n"],"\n",["p",null,"Get a property's value from the store."],"\n\n",["h3",{"id":"store-set-propname-value"},"\n  ",["a",{"class":"heading-link","href":"#store-set-propname-value"},["app-icon",{"name":"link"}],"\n  ",["code",null,"store.set(propName, value)"],"\n  "],"\n"],"\n",["p",null,"Set a property's value in the store."],"\n\n",["h3",{"id":"store-reset"},"\n  ",["a",{"class":"heading-link","href":"#store-reset"},["app-icon",{"name":"link"}],"\n  ",["code",null,"store.reset()"],"\n  "],"\n"],"\n",["p",null,"Reset the store to its initial state."],"\n\n",["h3",{"id":"store-use-subscriptions"},"\n  ",["a",{"class":"heading-link","href":"#store-use-subscriptions"},["app-icon",{"name":"link"}],"\n  ",["code",null,"store.use(...subscriptions)"],"\n  "],"\n"],"\n",["p",null,"Use the given subscriptions in the store. A subscription is an object that defines one or more of the properties ",["code",null,"get"],", ",["code",null,"set"]," or ",["code",null,"reset"],"."],"\n\n",["h2",{"id":"testing"},"\n  ",["a",{"class":"heading-link","href":"#testing"},["app-icon",{"name":"link"}],"\n  Testing\n  "],"\n"],"\n",["p",null,"Like any global state library, state should be reset between each spec test.\nUse the ",["code",null,"dispose()"]," API in the ",["code",null,"beforeEach"]," hook."],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-ts"},["code",{"class":"language-ts"},"import store from '../store';\n\nbeforeEach(() => {\n  store.dispose();\n});"]],"\n  "]]}