{"title":"End-to-end Testing - Stencil","description":"End-to-end Testing","url":"/docs/end-to-end-testing","contributors":["adamdbradley","mattdsteele","simonhaenisch","andrzejtemplin","robaxelsen","Nhiokh","DangoDev","jthoms1"],"lastUpdated":"2020-03-06T21:52:09Z","headings":[{"id":"end-to-end-testing","level":1,"text":"End-to-end Testing"},{"id":"example-end-to-end-test","level":2,"text":"Example End-to-end Test"},{"id":"e2e-testing-recipes","level":2,"text":"E2E Testing Recipes"},{"id":"find-an-element-in-the-shadow-dom","level":4,"text":"Find an element in the Shadow DOM"},{"id":"set-a-prop-on-a-component","level":4,"text":"Set a @Prop() on a component"},{"id":"set-a-prop-on-a-component-using-an-external-reference","level":4,"text":"Set a @Prop() on a component using an external reference"},{"id":"call-a-method-on-a-component","level":4,"text":"Call a @Method() on a component"},{"id":"type-inside-an-input-field","level":4,"text":"Type inside an input field"},{"id":"checking-the-text-of-a-rendered-component","level":4,"text":"Checking the text of a rendered component"},{"id":"checking-a-component-s-html","level":4,"text":"Checking a component&#39;s HTML"},{"id":"caveat-about-e2e-tests-automation-on-cd-ci","level":2,"text":"Caveat about e2e tests automation on CD/CI"}],"srcPath":"./src/docs/testing/e2e-testing.md","hypertext":["div",null,["h1",{"id":"end-to-end-testing"},"\n  \n  End-to-end Testing\n  \n"],"\n",["p",null,"E2E tests verify your components in a real browser. For example, when ",["code",null,"my-component"]," has the X attribute, the child component then renders the text Y, and expects to receive the event Z. By using Puppeteer for rendering tests (rather than a Node environment simulating how a browser works), your end-to-end tests are able to run within an actual browser in order to give better results."],"\n",["p",null,"Stencil provides many utility functions to help test ",["a",{"href":"https://jestjs.io/"},"Jest"]," and ",["a",{"href":"https://pptr.dev/"},"Puppeteer"],". For example, a component's shadow dom can be queried and tested with the Stencil utility functions built on top of Puppeteer. Tests can not only be provided mock HTML content, but they can also go to URLs of your app which Puppeteer is able to open up and test on Stencil's dev server."],"\n",["p",null,"End-to-end tests require a fresh build, dev-server, and puppeteer browser instance created before the tests can actually run. With the added build complexities, the ",["code",null,"stencil test"]," command is able to organize the build requirements beforehand."],"\n",["p",null,"To run E2E tests, run ",["code",null,"stencil test --e2e"],". By default, files ending in ",["code",null,".e2e.ts"]," will be executed."],"\n",["p",null,"Stencil's E2E test are provided with the following API, available via ",["code",null,"@stencil/core/testing"],".\nMost methods are async and return Promises. Use ",["code",null,"async"]," and ",["code",null,"await"]," to declutter your tests."],"\n",["ul",null,"\n",["li",null,["code",null,"newE2EPage"],": Should be invoked at the start of each test to instantiate a new ",["code",null,"E2EPage"]," object"],"\n"],"\n",["p",null,["code",null,"E2EPage"]," is a wrapper utility to Puppeteer to simplify writing tests. Some helpful methods on ",["code",null,"E2EPage"]," include:"],"\n",["ul",null,"\n",["li",null,["code",null,"setContent(html: string)"],": Sets the content of a page. This is where you would include the markup of the component under test."],"\n",["li",null,["code",null,"find(selector: string)"],": Find an element that matches the selector. Similar to ",["code",null,"document.querySelector"],"."],"\n",["li",null,["code",null,"waitForChanges()"],": Both Stencil and Puppeteer have an asynchronous architecture, which is a good thing for performance. Since all calls are async, it's required that ",["code",null,"await page.waitForChanges()"]," is called when changes are made to components."],"\n"],"\n",["p",null,"An example E2E test might have the following boilerplate:"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-typescript"},["code",{"class":"language-typescript"},["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," newE2EPage ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'@stencil/core/testing'"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token function"},"describe"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'example'"],["span",{"class":"token punctuation"},","]," ",["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"]," ",["span",{"class":"token operator"},"=>"]," ",["span",{"class":"token punctuation"},"{"],"\n  ",["span",{"class":"token function"},"it"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'should render a foo-component'"],["span",{"class":"token punctuation"},","]," ",["span",{"class":"token keyword"},"async"]," ",["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"]," ",["span",{"class":"token operator"},"=>"]," ",["span",{"class":"token punctuation"},"{"],"\n    ",["span",{"class":"token keyword"},"const"]," page ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"await"]," ",["span",{"class":"token function"},"newE2EPage"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n    ",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"setContent"],["span",{"class":"token punctuation"},"("],["span",{"class":"token template-string"},["span",{"class":"token template-punctuation string"},"`"],["span",{"class":"token string"},"<foo-component></foo-component>"],["span",{"class":"token template-punctuation string"},"`"]],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n    ",["span",{"class":"token keyword"},"const"]," el ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"find"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'foo-component'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n    ",["span",{"class":"token function"},"expect"],["span",{"class":"token punctuation"},"("],"el",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},"."],"not",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"toBeNull"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n  ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  \n",["h2",{"id":"example-end-to-end-test"},"\n  ",["a",{"class":"heading-link","href":"#example-end-to-end-test"},["app-icon",{"name":"link"}],"\n  Example End-to-end Test\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-typescript"},["code",{"class":"language-typescript"},["span",{"class":"token keyword"},"import"]," ",["span",{"class":"token punctuation"},"{"]," newE2EPage ",["span",{"class":"token punctuation"},"}"]," ",["span",{"class":"token keyword"},"from"]," ",["span",{"class":"token string"},"'@stencil/core/testing'"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token function"},"it"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'should create toggle, unchecked by default'"],["span",{"class":"token punctuation"},","]," ",["span",{"class":"token keyword"},"async"]," ",["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"]," ",["span",{"class":"token operator"},"=>"]," ",["span",{"class":"token punctuation"},"{"],"\n  ",["span",{"class":"token keyword"},"const"]," page ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"await"]," ",["span",{"class":"token function"},"newE2EPage"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n  ",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"setContent"],["span",{"class":"token punctuation"},"("],["span",{"class":"token template-string"},["span",{"class":"token template-punctuation string"},"`"],["span",{"class":"token string"},"\n    <ion-toggle class=\"pretty-toggle\"></ion-toggle>\n  "],["span",{"class":"token template-punctuation string"},"`"]],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n  ",["span",{"class":"token keyword"},"const"]," ionChange ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"spyOnEvent"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'ionChange'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n  ",["span",{"class":"token keyword"},"const"]," toggle ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"find"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'ion-toggle'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n  ",["span",{"class":"token function"},"expect"],["span",{"class":"token punctuation"},"("],"toggle",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"toHaveClasses"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},"["],["span",{"class":"token string"},"'pretty-toggle'"],["span",{"class":"token punctuation"},","]," ",["span",{"class":"token string"},"'hydrated'"],["span",{"class":"token punctuation"},"]"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n  ",["span",{"class":"token function"},"expect"],["span",{"class":"token punctuation"},"("],"toggle",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},"."],"not",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"toHaveClass"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'toggle-checked'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n  toggle",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"setProperty"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'checked'"],["span",{"class":"token punctuation"},","]," ",["span",{"class":"token boolean"},"true"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n  ",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"waitForChanges"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n  ",["span",{"class":"token function"},"expect"],["span",{"class":"token punctuation"},"("],"toggle",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"toHaveClass"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'toggle-checked'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n  ",["span",{"class":"token function"},"expect"],["span",{"class":"token punctuation"},"("],"ionChange",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"toHaveReceivedEventDetail"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},"{"],"\n    checked",["span",{"class":"token operator"},":"]," ",["span",{"class":"token boolean"},"true"],["span",{"class":"token punctuation"},","],"\n    value",["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'on'"],"\n  ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  \n",["h2",{"id":"e2e-testing-recipes"},"\n  ",["a",{"class":"heading-link","href":"#e2e-testing-recipes"},["app-icon",{"name":"link"}],"\n  E2E Testing Recipes\n  "],"\n"],"\n\n",["h4",{"id":"find-an-element-in-the-shadow-dom"},"\n  ",["a",{"class":"heading-link","href":"#find-an-element-in-the-shadow-dom"},["app-icon",{"name":"link"}],"\n  Find an element in the Shadow DOM\n  "],"\n"],"\n",["p",null,"Use the \"piercing\" selector ",["code",null,">>>"]," to query for an object inside a component's shadow root:"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-typescript"},["code",{"class":"language-typescript"},["span",{"class":"token keyword"},"const"]," el ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"find"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'foo-component >>> .close-button'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  \n",["h4",{"id":"set-a-prop-on-a-component"},"\n  ",["a",{"class":"heading-link","href":"#set-a-prop-on-a-component"},["app-icon",{"name":"link"}],"\n  Set a @Prop() on a component\n  "],"\n"],"\n",["p",null,"Use ",["code",null,"page.$eval"]," (part of the Puppeteer API) to set props or otherwise manipulate a component:"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-typescript"},["code",{"class":"language-typescript"},["span",{"class":"token comment"},"// create a new puppeteer page"],"\n",["span",{"class":"token comment"},"// load the page with html content"],"\n",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"setContent"],["span",{"class":"token punctuation"},"("],["span",{"class":"token template-string"},["span",{"class":"token template-punctuation string"},"`"],["span",{"class":"token string"},"\n      <prop-cmp></prop-cmp>\n    "],["span",{"class":"token template-punctuation string"},"`"]],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token comment"},"// select the \"prop-cmp\" element"],"\n",["span",{"class":"token comment"},"// and run the callback in the browser's context"],"\n",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"$eval"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'prop-cmp'"],["span",{"class":"token punctuation"},","]," ",["span",{"class":"token punctuation"},"("],"elm",["span",{"class":"token operator"},":"]," ",["span",{"class":"token builtin"},"any"],["span",{"class":"token punctuation"},")"]," ",["span",{"class":"token operator"},"=>"]," ",["span",{"class":"token punctuation"},"{"],"\n  ",["span",{"class":"token comment"},"// within the browser's context"],"\n  ",["span",{"class":"token comment"},"// let's set new property values on the component"],"\n  elm",["span",{"class":"token punctuation"},"."],"first ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token string"},"'Marty'"],["span",{"class":"token punctuation"},";"],"\n  elm",["span",{"class":"token punctuation"},"."],"lastName ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token string"},"'McFly'"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token comment"},"// we just made a change and now the async queue need to process it"],"\n",["span",{"class":"token comment"},"// make sure the queue does its work before we continue"],"\n",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"waitForChanges"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  \n",["h4",{"id":"set-a-prop-on-a-component-using-an-external-reference"},"\n  ",["a",{"class":"heading-link","href":"#set-a-prop-on-a-component-using-an-external-reference"},["app-icon",{"name":"link"}],"\n  Set a @Prop() on a component using an external reference\n  "],"\n"],"\n",["p",null,"Because ",["code",null,"page.$eval"]," has an isolated scope, you’ll have to explicity pass in outside references otherwise you’ll an encounter an ",["code",null,"undefined"]," error. This is useful in case you’d like to import data from another file, or re-use mock data across multiple tests in the same file."],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-typescript"},["code",{"class":"language-typescript"},["span",{"class":"token keyword"},"const"]," props ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token punctuation"},"{"],"\n  first",["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'Marty'"],["span",{"class":"token punctuation"},","],"\n  lastName",["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'McFly'"],["span",{"class":"token punctuation"},","],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"setContent"],["span",{"class":"token punctuation"},"("],["span",{"class":"token template-string"},["span",{"class":"token template-punctuation string"},"`"],["span",{"class":"token string"},"<prop-cmp></prop-cmp>"],["span",{"class":"token template-punctuation string"},"`"]],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"$eval"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'prop-cmp'"],["span",{"class":"token punctuation"},","],"\n  ",["span",{"class":"token punctuation"},"("],"elm",["span",{"class":"token operator"},":"]," ",["span",{"class":"token builtin"},"any"],["span",{"class":"token punctuation"},","]," ",["span",{"class":"token punctuation"},"{"]," first",["span",{"class":"token punctuation"},","]," lastName ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"]," ",["span",{"class":"token operator"},"=>"]," ",["span",{"class":"token punctuation"},"{"],"\n    elm",["span",{"class":"token punctuation"},"."],"first ",["span",{"class":"token operator"},"="]," first",["span",{"class":"token punctuation"},";"],"\n    elm",["span",{"class":"token punctuation"},"."],"lastName ",["span",{"class":"token operator"},"="]," lastName",["span",{"class":"token punctuation"},";"],"\n  ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},","],"\n  props \n",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"waitForChanges"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  \n",["h4",{"id":"call-a-method-on-a-component"},"\n  ",["a",{"class":"heading-link","href":"#call-a-method-on-a-component"},["app-icon",{"name":"link"}],"\n  Call a @Method() on a component\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-typescript"},["code",{"class":"language-typescript"},["span",{"class":"token keyword"},"const"]," elm ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"find"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'method-cmp'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\nelm",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"setProperty"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'someProp'"],["span",{"class":"token punctuation"},","]," ",["span",{"class":"token number"},"88"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"const"]," methodRtnValue ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"await"]," elm",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"callMethod"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'someMethod'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  \n",["h4",{"id":"type-inside-an-input-field"},"\n  ",["a",{"class":"heading-link","href":"#type-inside-an-input-field"},["app-icon",{"name":"link"}],"\n  Type inside an input field\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-typescript"},["code",{"class":"language-typescript"},["span",{"class":"token keyword"},"const"]," page ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"await"]," ",["span",{"class":"token function"},"newE2EPage"],["span",{"class":"token punctuation"},"("],["span",{"class":"token punctuation"},"{"],"\n  html",["span",{"class":"token operator"},":"]," ",["span",{"class":"token template-string"},["span",{"class":"token template-punctuation string"},"`"],["span",{"class":"token string"},"\n      <dom-interaction></dom-interaction>\n    "],["span",{"class":"token template-punctuation string"},"`"]],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"const"]," input ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"find"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'dom-interaction >>> .input'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"let"]," value ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"await"]," input",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"getProperty"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'value'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token function"},"expect"],["span",{"class":"token punctuation"},"("],"value",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"toBe"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"''"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"await"]," input",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"press"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'8'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"await"]," input",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"press"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'8'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"await"]," input",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"press"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"' '"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],"keyboard",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"down"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'Shift'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"await"]," input",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"press"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'KeyM'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"await"]," input",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"press"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'KeyP'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"await"]," input",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"press"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'KeyH'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],"keyboard",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"up"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'Shift'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  \n",["h4",{"id":"checking-the-text-of-a-rendered-component"},"\n  ",["a",{"class":"heading-link","href":"#checking-the-text-of-a-rendered-component"},["app-icon",{"name":"link"}],"\n  Checking the text of a rendered component\n  "],"\n"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-typescript"},["code",{"class":"language-typescript"},["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"setContent"],["span",{"class":"token punctuation"},"("],["span",{"class":"token template-string"},["span",{"class":"token template-punctuation string"},"`"],["span",{"class":"token string"},"\n      <prop-cmp first=\"Marty\" last-name=\"McFly\"></prop-cmp>\n    "],["span",{"class":"token template-punctuation string"},"`"]],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n\n",["span",{"class":"token keyword"},"const"]," elm ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token keyword"},"await"]," page",["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"find"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'prop-cmp >>> div'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n",["span",{"class":"token function"},"expect"],["span",{"class":"token punctuation"},"("],"elm",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"toEqualText"],["span",{"class":"token punctuation"},"("],["span",{"class":"token string"},"'Hello, my name is Marty McFly'"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  \n",["h4",{"id":"checking-a-component-s-html"},"\n  ",["a",{"class":"heading-link","href":"#checking-a-component-s-html"},["app-icon",{"name":"link"}],"\n  Checking a component's HTML\n  "],"\n"],"\n",["p",null,"For shadowRoot content:"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-typescript"},["code",{"class":"language-typescript"},"        ",["span",{"class":"token function"},"expect"],["span",{"class":"token punctuation"},"("],"el",["span",{"class":"token punctuation"},"."],"shadowRoot",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"toEqualHtml"],["span",{"class":"token punctuation"},"("],["span",{"class":"token template-string"},["span",{"class":"token template-punctuation string"},"`"],["span",{"class":"token string"},"<div>\n        <div class=\\\"nav-desktop\\\">\n          <slot></slot>\n        </div>\n      </div>"],["span",{"class":"token template-punctuation string"},"`"]],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n    ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  ",["p",null,"For non-shadow content:"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-typescript"},["code",{"class":"language-typescript"},"        ",["span",{"class":"token function"},"expect"],["span",{"class":"token punctuation"},"("],"el",["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},"."],["span",{"class":"token function"},"toEqualHtml"],["span",{"class":"token punctuation"},"("],["span",{"class":"token template-string"},["span",{"class":"token template-punctuation string"},"`"],["span",{"class":"token string"},"<div>\n        <div class=\\\"nav-desktop\\\">\n          <slot></slot>\n        </div>\n      </div>"],["span",{"class":"token template-punctuation string"},"`"]],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"],"\n    ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},")"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  \n",["h2",{"id":"caveat-about-e2e-tests-automation-on-cd-ci"},"\n  ",["a",{"class":"heading-link","href":"#caveat-about-e2e-tests-automation-on-cd-ci"},["app-icon",{"name":"link"}],"\n  Caveat about e2e tests automation on CD/CI\n  "],"\n"],"\n",["p",null,"As it is a fairly common practice, you might want to automatically run your end-to-end tests on your Continous Deployment/Integration (CD/CI) system. However, some environments might need you to tweak your configuration at times. If so, the ",["code",null,"config"]," object in your ",["code",null,"stencil.config.ts"]," file has a ",["code",null,"testing"]," attribute that accepts parameters to modify how Headless Chrome is actually used in your pipeline."],"\n",["p",null,"Example of a config you might need in a Gitlab CI environment :"],"\n\n  ",["highlight-code",null,"\n    ",["pre",{"class":"language-typescript"},["code",{"class":"language-typescript"},["span",{"class":"token keyword"},"export"]," ",["span",{"class":"token keyword"},"const"]," config",["span",{"class":"token operator"},":"]," Config ",["span",{"class":"token operator"},"="]," ",["span",{"class":"token punctuation"},"{"],"\n  ",["span",{"class":"token keyword"},"namespace"],["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'Foo'"],["span",{"class":"token punctuation"},","],"\n  testing",["span",{"class":"token operator"},":"]," ",["span",{"class":"token punctuation"},"{"],"\n    ",["span",{"class":"token comment"},"/**\n     * Gitlab CI doesn't allow sandbox, therefor this parameters must be passed to your Headless Chrome\n     * before it can run your tests\n     */"],"\n    browserArgs",["span",{"class":"token operator"},":"]," ",["span",{"class":"token punctuation"},"["],["span",{"class":"token string"},"'--no-sandbox'"],["span",{"class":"token punctuation"},","]," ",["span",{"class":"token string"},"'--disable-setuid-sandbox'"],["span",{"class":"token punctuation"},"]"],["span",{"class":"token punctuation"},","],"\n  ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},","],"\n  outputTargets",["span",{"class":"token operator"},":"]," ",["span",{"class":"token punctuation"},"["],"\n    ",["span",{"class":"token punctuation"},"{"]," ",["span",{"class":"token keyword"},"type"],["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'dist'"]," ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},","],"\n    ",["span",{"class":"token punctuation"},"{"],"\n      ",["span",{"class":"token keyword"},"type"],["span",{"class":"token operator"},":"]," ",["span",{"class":"token string"},"'www'"],["span",{"class":"token punctuation"},","],"\n    ",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},","],"\n  ",["span",{"class":"token punctuation"},"]"],["span",{"class":"token punctuation"},","],"\n",["span",{"class":"token punctuation"},"}"],["span",{"class":"token punctuation"},";"]]],"\n  "],"\n  ",["p",null,"Check ",["a",{"href":"https://stenciljs.com/docs/config#testing"},"this part of the doc"]," to learn more about the possibilities on this matter. "]]}